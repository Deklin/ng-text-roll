!function(){"use strict";angular.module("ui.ngTextRoll",["ui.ngTextRoll.template"]).controller("ngTextRollCtrl",["$element","$document","$timeout","ngTextRollSvc","ngTextRollUtilSvc",function(a,b,c,d,e){var f=this;f.current=0,f.render=[{},{}],f.height=e.getHeight(a,b),f.$onInit=function(){f.svc=d,f.heightValue=parseFloat(f.height),f.offset=Number(Math.round(.5*f.heightValue+"e2")+"e-2"),f.heightUnit=f.height.replace(f.heightValue,""),f.svc.init(f)},f.$onDestroy=function(){c.cancel(f.animTimeout)},f.$onChanges=function(a){a.target&&(f.config=f.config||{},void 0!==a.target.previousValue.constructor()&&d.roll(f,a.target.previousValue,a.target.currentValue))}}]).factory("ngTextRollUtilSvc",function(){var a={};return a.randDec=function(a,b){return parseFloat((Math.random()*(b-a)+a).toFixed(2))},a.buildRange=function(a,b,c){for(var d=b.charCodeAt(0),e=c.charCodeAt(0),f=Math.abs(d-e),g=[],h=0;h<f;h++)a?g.push(String.fromCharCode(d<e?--e:++e)):g.push(String.fromCharCode(d<e?d++:d--));return 0===f&&g.push(String.fromCharCode(d)),g},a.getCompStyle=function(a,b){return a.currentStyle?a.currentStyle:b[0].defaultView&&b[0].defaultView.getComputedStyle?b[0].defaultView.getComputedStyle(a[0]):a.style},a.getHeight=function(b,c){var d=a.getCompStyle(b,c);return d.fontSize?d.fontSize:d["font-size"]?d["font-size"]:d.height&&"auto"!==d.height?d.height:"1em"},a}).factory("ngTextRollSvc",["$timeout","$filter","ngTextRollUtilSvc",function(a,b,c){var d={},e="0",f="top Xs ease-in-out, bottom Xs ease-in-out",g=/X/g,h={min:.3,max:.8},i=function(a,c){for(var d=(a&&a.filter?b(a.filter)(c,a.filterParam1,a.filterParam2,a.filterParam3):String(c)).split(""),e=0;e<d.length;e++)d[e]=" "===d[e]?"nbsp;":d[e];return d},j=function(a,b){return f.replace(g,c.randDec(h.min,h.max)*(a.config.rollBetween===!1?1:.5*(b>5?5:b)))},k=function(a,b){return!a.config.rollAll&&(a.render[a.current].target[b]&&a.render[a.current].target[b][0])===(a.render[a.notCurrent].target[b]&&a.render[a.notCurrent].target[b][0])};d.init=function(a){a.render[a.current].style={top:e},a.render[a.current].target=i(a.config,a.target)};var l=function(a,b,d,e){var f=i(a.config,d),g=i(a.config,b),h=f.length!==g.length;return h||a.config.rollBetween===!1?a.render[a.current].target=f:(a.render[a.current].target=[],angular.forEach(f,function(b,d){"nbsp;"===b?a.render[a.current].target.push(b):a.render[a.current].target.push(c.buildRange(e,b,g[d]))})),a.render[a.notCurrent].target=g,h},m=function(a,b,c,d){a.render[a.current].style=[],angular.forEach(a.render[a.current].target,function(b,c){var e={"-webkit-transition":void 0,"-moz-transition":void 0,transition:void 0},f=b.length;d?(e.top=a.heightValue+a.heightUnit,e.bottom=a.heightValue*f*-1+a.heightUnit):(e.top=a.heightValue*f*-1+a.heightUnit,e.bottom=a.heightValue+a.heightUnit),a.render[a.current].style.push(e)}),a.render[a.notCurrent].style=[],angular.forEach(a.render[a.notCurrent].target,function(){var b={"-webkit-transition":void 0,"-moz-transition":void 0,transition:void 0,top:e,bottom:e};a.render[a.notCurrent].style.push(b)})},n=function(a,b,c){a.config=a.config||{},angular.forEach(a.render[a.current].style,function(c,d){if(!k(a,d)){var f=j(a,a.render[a.current].target[d].length);c["-webkit-transition"]=f,c["-moz-transition"]=f,c.transition=f,b?(c.top=void 0,c.bottom=e):(c.bottom=void 0,c.top=e)}}),angular.forEach(a.render[a.notCurrent].style,function(d,e){if(!k(a,e)){var f=j(a,1);d["-webkit-transition"]=f,d["-moz-transition"]=f,d.transition=f,b?(d.top=void 0,d.bottom=a.heightValue+a.offset+a.heightUnit):(d.top=a.heightValue+a.offset+a.heightUnit,d.bottom=void 0),c&&(d["-webkit-filter"]="blur(5px)",d.filter="blur(5px)")}})};return d.roll=function(b,c,d){var e=d>c;b.notCurrent=b.current,b.current=1^b.current;var f=l(b,c,d,e);m(b,c,d,e,f),b.animTimeout=a(n,25,!0,b,e,f)},d}]).component("ngTextRoll",{templateUrl:"template/ngtextroll.html",bindings:{target:"<",config:"<"},controller:"ngTextRollCtrl"}),angular.module("ui.ngTextRoll.template",[]).run(["$templateCache",function(a){a.put("template/ngtextroll.html",'<div id="ng-text-roll">\n  <div class="inner" ng-repeat="pChar in $ctrl.render[$ctrl.current].target track by $index">\n    <div class="char" ng-show="pChar !== \'nbsp;\'" ng-style="$ctrl.render[0].style[$index]">\n      <div ng-repeat="iChar in $ctrl.render[0].target[$index]">{{iChar}}</div>\n    </div>\n    <div class="char" ng-show="pChar !== \'nbsp;\'" ng-style="$ctrl.render[1].style[$index]">\n      <div ng-repeat="jChar in $ctrl.render[1].target[$index]">{{jChar}}</div>\n    </div>\n    {{pChar === \'nbsp;\' ? \'&nbsp;\' : pChar[0]}}\n  </div>\n</div>\n')}])}();